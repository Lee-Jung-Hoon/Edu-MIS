<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="attendance"> 
	<select id="memList" resultMap="mem">
		select no, name 
		from t_member 
	</select>
	
	<resultMap type="memberVO" id="mem">
		<result property="no" column="no"></result>
		<result property="name" column="name"></result>
	</resultMap>
	
	<resultMap type="AdminAttVO" id="att">
		<result property="mNo" column="mNo"></result>
		<result property="mName" column="mName"></result>
		<result property="attType" column="att_type"></result>
		<result property="attDate" column="att_date"></result>
	</resultMap>
	
	<resultMap type="AdminAttVO" id="attMem">
		<result property="mNo" column="mNo"></result>
		<result property="mName" column="mName"></result>
		<result property="attType" column="att_type"></result>
		<result property="attDate" column="att_date"></result>
	</resultMap>
	
	
<!-- create table t_member( -->
<!--    no number primary key, -->
<!--    id varchar2(10) not null, -->
<!--    name varchar2(30) not null, -->
<!--    pass varchar2(30) not null, -->
<!--    pass_chk varchar2(30) not null, -->
<!--    year varchar2(4) not null, -->
<!--    month varchar2(4) not null, -->
<!--    day varchar2(4) not null, -->
<!--    post_no char(7) not null,   -->
<!--    basic_addr varchar2(100) not null, -->
<!--    detail_addr varchar2(100) not null, -->
<!--    phone1 char(3) not null, -->
<!--    phone2 char(4) not null, -->
<!--    phone3 char(4) not null, -->
<!--    email varchar2(30) not null, -->
<!--    email_domain varchar2(20) not null, -->
<!--    major varchar2(10) not null, -->
<!--    join_date date default sysdate,	 -->
	

	
<!-- 	private int mNo; -->
<!-- 	private String attDate; -->
<!-- 	private int attType; -->
<!-- 	create table t_attend( -->
<!-- 	mNo number ,					 -->
<!-- 	att_date date default sysdate,	 -->
<!-- 	att_type number,				 -->
<!-- 	primary key(mNo, att_date) -->
<!-- ) -->
	<select id="attList" resultMap="att"> 
		select att_type, to_char(att_date, 'yyyy-mm-dd') as att_date, mName, mNo
		from t_attend 
	</select>
	
	<select id="attMemList" parameterType="string" resultMap="attMem"> 
		select att_type, to_char(att_date, 'yyyy-mm-dd') as att_date
		from t_attend 
		where mNo = #{mNo}
	</select>
	
	<insert id="insertAttendance" parameterType="AdminAttVO">
        insert into t_attend (
            mNo, mName, att_type
        ) values (
            #{mNo}, #{mName}, #{attType}
        )
  </insert>
    
    <update id="updateAttendance" parameterType="AdminAttVO" >
        update t_attend
           set att_type = #{attType}
         where mNo  = #{mNo}
    </update>
</mapper>